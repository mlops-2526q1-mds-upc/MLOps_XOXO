[INFO] Seed set to 42
[INFO] Model directory: models/emotion_classification
[INFO] Report directory: reports/emotion_classification
[INFO] MLflow experiment: emotion_classification (ID: 7)
  ‚Üí Apple MPS (Metal Performance Shaders) available
[INFO] Using device: mps
[INFO] Image size: 48x48
[INFO] Loading training data from data/processed/emotion_classification/train
[INFO] Classes found: ['Angry', 'Disgust', 'Fear', 'Happy', 'Neutral', 'Sad', 'Surprise']
[INFO] Number of classes: 7
[INFO] Loading validation data from data/processed/emotion_classification/val
[INFO] Train dataset size: 22604, Val dataset size: 4841
[INFO] Batch size: 32
[INFO] Building ResNet18 model with 1-channel input...
[INFO] Starting MLflow run: emotion_classification_200_epochs
[INFO] Logged training parameters to MLflow
[INFO] Starting training for 1 epochs...
Epoch 1/1 | Train Loss: 1.5132 | Train Acc: 0.4286 | Train Macro F1: 0.3321
                 Val Acc: 0.4985 | Val Macro F1: 0.3840
[INFO] ‚úì New best model saved at epoch 1 (val_macro_f1=0.3840)
[INFO] Training complete!
[INFO] Loading best model from models/emotion_classification/best_model.pth
[INFO] Saved test metrics to reports/emotion_classification/test_metrics_20251118_013848.json
[INFO] Final validation accuracy: 0.4985
[INFO] Final validation macro F1: 0.3840
[INFO] Uploading model and artifacts to MLflow...
[INFO] ‚úì Model uploaded to MLflow
[INFO] ‚úì Test metrics uploaded to MLflow
[INFO] ‚úÖ Training complete and all artifacts logged to MLflow!
[INFO] Best model achieved val_macro_f1=0.3840 at epoch 1
üèÉ View run emotion_classification_200_epochs at: https://dagshub.com/pawarit.jamjod/MLOps_XOXO.mlflow/#/experiments/7/runs/391e2a0366b84b649de972aa6724b78d
üß™ View experiment at: https://dagshub.com/pawarit.jamjod/MLOps_XOXO.mlflow/#/experiments/7
